# MyPPT - 基于Java的幻灯片制作与播放软件

**项目作者**: LHZ
**项目编译以及运行说明在最下方，前面介绍可以跳过**

所有代码由我个人完成，拒绝抄袭，下方为github仓库以及完善整个架构的所有git提交。

**GitHub仓库**: [https://github.com/aptxLHZ/MyPowerPoint](https://github.com/aptxLHZ/MyPowerPoint)
**Commit 历史**: [https://github.com/aptxLHZ/MyPowerPoint/commits/main/](https://github.com/aptxLHZ/MyPowerPoint/commits/main/)

---

## 项目代码架构简介

我的项目遵循经典的 **MVC (Model-View-Controller)** 设计模式，并结合了 **命令模式 (Command)** 和 **策略模式 (Strategy)**。

```
MyPowerPoint Project
├── src/
│   └── com/
│       └── myppt/
│           │
│           ├── App.java  // [入口] 程序的主入口，包含 main 方法，负责启动应用。
│           │
│           ├── commands/  // [命令模式] 存放所有可撤销/重做的操作指令
│           │   ├── Command.java             // 命令接口，定义 execute 和 undo 方法。
│           │   ├── AddObjectCommand.java    // 添加对象（图形/文本/图片）的命令。
│           │   ├── DeleteObjectCommand.java // 删除对象的命令。
│           │   ├── ChangeBorderCommand.java // 修改边框/线条属性（颜色、粗细、样式）的命令。
│           │   ├── ChangeColorCommand.java  // 修改填充色或文字颜色的命令。
│           │   ├── ChangeFontCommand.java   // 修改字体属性（加粗、斜体、字号等）的命令。
│           │   ├── ChangeTextCommand.java   // 修改文本框内容的命令。
│           │   ├── ChangeOpacityCommand.java // 修改图片透明度的命令。
│           │   ├── ChangeZOrderCommand.java // 修改图层顺序（置顶/置底）的命令。
│           │   ├── ChangeStyleCommand.java  // 格式刷应用样式的命令。
│           │   └── TransformCommand.java    // 移动或缩放对象的命令。
│           │
│           ├── controller/  // [控制层] 核心逻辑与协调者
│           │   ├── AppController.java       // [核心] 主控制器，协调 Model、View 和各个 Handler。
│           │   ├── ActionHandler.java       // 处理具体业务动作（如复制粘贴、播放、修改属性逻辑）。
│           │   ├── FileHandler.java         // 处理文件 I/O（新建、打开、保存、导出PDF）。
│           │   ├── UIUpdater.java           // 负责更新界面显示（属性面板、缩略图列表、标题栏）。
│           │   ├── ListenerSetup.java       // 负责初始化并绑定所有的事件监听器（鼠标、键盘、按钮）。
│           │   ├── AutosaveManager.java     // 管理后台自动保存和崩溃恢复逻辑。
│           │   ├── CanvasController.java    // 画布的鼠标事件转发器，将事件分发给当前的 Strategy。
│           │   ├── UndoManager.java         // 管理撤销栈和重做栈。
│           │   └── strategies/  // [策略模式] 处理画布上的鼠标交互逻辑
│           │       ├── InteractionStrategy.java // 交互策略接口。
│           │       ├── SelectStrategy.java      // “选择模式”策略（点击选择、拖拽移动、拉伸变形）。
│           │       ├── DrawObjectStrategy.java  // “绘制图形模式”策略（矩形、椭圆、文本框）。
│           │       ├── DrawLineStrategy.java    // “绘制直线模式”策略。
│           │       ├── NullStrategy.java        // 空策略（什么都不做）。
│           │       └── ResizeHandle.java        // 枚举，定义调整手柄的位置（如左上、右下等）。
│           │
│           ├── model/  // [模型层] 数据结构
│           │   ├── Presentation.java        // 整个演示文稿的数据，包含多个 Slide。
│           │   ├── Slide.java               // 单个幻灯片页面的数据，包含多个 Object。
│           │   ├── AbstractSlideObject.java // 所有页面元素（图形、文本、图片）的抽象基类。
│           │   ├── RectangleShape.java      // 矩形对象模型。
│           │   ├── EllipseShape.java        // 椭圆对象模型。
│           │   ├── LineShape.java           // 直线对象模型。
│           │   ├── TextBox.java             // 文本框对象模型。
│           │   ├── ImageObject.java         // 图片对象模型。
│           │   ├── Style.java               // 样式接口（用于格式刷）。
│           │   ├── ShapeStyle.java          // 图形样式封装。
│           │   ├── TextStyle.java           // 文本样式封装。
│           │   ├── ImageStyle.java          // 图片样式封装。
│           │   └── NullStyle.java           // 空样式。
│           │
│           ├── utils/  // [工具类]
│           │   └── PdfExporter.java         // 使用 PDFBox 库将幻灯片绘制并导出为 PDF 文件。
│           │
│           └── view/   // [视图层] 用户界面组件
│               ├── MainFrame.java           // 主程序窗口（菜单栏、工具栏、属性面板容器）。
│               ├── CanvasPanel.java         // 核心绘图区域，负责渲染幻灯片内容。
│               ├── ThumbnailPanel.java      // 左侧缩略图列表容器。
│               ├── SlideThumbnail.java      // 单个缩略图组件。
│               └── PlayerFrame.java         // 全屏播放模式的窗口。
│
└── main/resources/
    └── help.html   // 帮助文档的 HTML 内容。
```

---

## 如何编译与运行

本项目支持在集成开发环境 (IDE) 如 VS Code 中可视化运行，也支持通过命令行进行编译和执行，完美兼容 Windows, macOS, Linux 等操作系统。

### **I. 前提条件**

确保您的系统已安装 JDK 8 或更高版本 (推荐 JDK 11/17)。

您可以通过在终端/命令行执行 `java -version` 和 `javac -version` 来验证安装情况。

### **II. 使用 VS Code 运行 (推荐)**

这是最便捷的运行方式，尤其适合开发调试。

1. **安装 VS Code**: 从 [VS Code 官网](https://code.visualstudio.com/) 下载并安装。

2. **安装 Java 扩展**: 在 VS Code 中打开扩展视图 (Ctrl+Shift+X)，搜索并安装 **"Extension Pack for Java"** (由Microsoft提供)。

3. **获取项目代码**:
   
   * **方式一**: 下载作业压缩包，并解压到本地目录。
   
   * **方式二** : 从 GitHub 克隆项目。
     
     ```bash
     git clone https://github.com/aptxLHZ/MyPowerPoint.git
     cd MyPowerPoint
     ```

4. **打开项目**:
   
   * 在 VS Code 中，选择 `File` -> `Open Folder...`。
   * 导航到您克隆或解压的项目根目录 (`MyPowerPoint/`) 并打开。

5. **自动识别依赖**: VS Code 的 Java 扩展会自动识别 `src/` 目录下的源代码和 `lib/` 目录下的 JAR 依赖 (包括 PDFBox)。您可以在左侧的 "Java Projects" 视图中 "Referenced Libraries" 节点下进行确认。

6. **运行**:
   
   * 打开 `src/com/myppt/App.java` 文件。
   * 在 `public static void main(String[] args)` 方法的上方，您会看到一个绿色的 **"Run"** 按钮。点击它即可启动程序。
   * MyPPT 成功启动，**提示自动回复未保存文件**，这也是本项目亮点之一。

### **III. 使用命令行运行**

适合在没有 IDE 的环境下进行编译和执行。

1. **获取项目代码**:
   
   * **方式一**: 下载作业压缩包，并解压到本地目录。
   
   * **方式二**: 从 GitHub 克隆项目。
     
     ```bash
     git clone https://github.com/aptxLHZ/MyPowerPoint.git
     cd MyPowerPoint     
     ```

2. **打开终端/命令行**:
   
   * **Windows**: 打开 `Git Bash` (推荐)、`PowerShell` 或 `CMD`。
   
   * **macOS / Linux**: 打开您的终端应用。
   
   * **导航到项目根目录**:
     
     ```bash
     cd path/to/MyPowerPoint # 将 path/to/MyPowerPoint 替换为您的实际路径
     ```

3. **编译源代码**:
   
   * 在编译前，建议先清理并重建 `bin/` 目录，确保编译环境干净。
     
     * **Windows**:
       
       ```bash
       rmdir /s /q bin
       mkdir bin
       ```
     
     * **macOS / Linux**:
       
       ```bash
       rm -rf bin
       mkdir bin
       ```
   
   * 执行编译命令:
     
     * **Windows**:
       
       ```bash
       javac -d bin -sourcepath src -classpath "lib/*" src/com/myppt/App.java
       ```
     
     * **macOS / Linux**: (注意 `-classpath` 中的路径分隔符是 `:` )
       
       ```bash
       javac -d bin -sourcepath src -classpath "lib/*" src/com/myppt/App.java
       ```
   
   * 如果编译成功，控制台通常不会有任何输出（或仅有警告）。您可以检查 `bin/com/myppt/App.class` 文件是否已生成。

4. **运行字节码**:
   
   * 执行运行命令:
     
     * **Windows**:
       
       ```bash
       java -classpath "bin;lib/*" com.myppt.App
       ```
     
     * **macOS / Linux**: 
       
       ```bash
       java -classpath "bin;lib/*" com.myppt.App
       ```
   
   * MyPPT 成功启动，**提示自动回复未保存文件**，这也是本项目亮点之一。

## 功能说明 (请在程序内部查看更详尽的版本)

为了获得最佳的用户体验和最详细的功能介绍，强烈建议您在程序运行后，**点击菜单栏【帮助】->【使用说明】进行查看。**



| 分类            | 作业要求                               | **完成状态**  | **实现细节与超额完成项 (项目亮点)**                                                                                                                                                                                                                          |
| ------------- | ---------------------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **基本功能**      | 1. 新建幻灯片                           | ✅ **已完成** | - 通过“文件 -> 新建”菜单项实现。<br>- **智能保存提示**: 新建前若文件已修改，会弹出专业对话框询问是否保存。                                                                                                                                                                                |
|               | 2. 新建一个空白幻灯片页面                     | ✅ **已完成** | - 通过工具栏“新建页面”按钮实现。<br>- 支持**连续创建**多个页面。                                                                                                                                                                                                        |
|               | 3. 打开或保存整个幻灯片                      | ✅ **已完成** | - **核心技术**: 使用了核心的 **Java 对象序列化 (Serializable)** 技术。<br>- **功能**: 实现了完整的“打开”、“保存”、“另存为”功能。<br>- **文件格式**: 保存为自定义的 .myppt 格式文件。<br>- **智能流程**: 完美处理用户在保存/打开对话框中点击“取消”的情况，程序不会意外退出。<br>- **文件状态可视化**: 主窗口标题栏能**动态显示**当前文件名，并在文件有修改时**自动添加星号 ***。 |
|               | 4. 在幻灯片页面上添加文本框...可以添加文字           | ✅ **已完成** | - **UI**: 使用 JTextArea 嵌入 JOptionPane 的方式，提供了**支持多行文本输入**的对话框。<br>- **核心算法**: 实现了基于字符的**自动换行 (Word Wrap)** 算法，**完美支持中文文本**。<br>- **智能尺寸**: 文本框能随字体增大而**自动增大包围盒**，确保文字始终在可点击区域内，解决了“点不中”的痛点。                                                    |
|               | 5. 设定文字的颜色、大小和风格（种类≥3种）            | ✅ **已完成** | - **UI**: 在属性面板集成了字体选择框(JComboBox)、字号微调器(JSpinner)、粗体/斜体复选框(JCheckBox)。<br>- **功能**: 实现了对文字**颜色**、**大小**、**字体**、**粗体**、**斜体**的完整修改。<br>- **健壮性**: 解决了UI更新时可能导致的事件“串扰”问题，确保样式设置的准确性。                                                            |
|               | 6. ...绘制基本图形...设定填充颜色和边框颜色         | ✅ **已完成** | - **图形**: 绘制了矩形、圆形、椭圆和直线。<br>- **颜色**: 实现了对**填充色**和**边框色**（直线是线条色）的**分别**设定。                                                                                                                                                                   |
|               | 7. 在幻灯片页面上插入图片                     | ✅ **已完成** | - **UI**: 使用 JFileChooser 并设置了**文件过滤器**，只显示常用图片格式。<br>- **核心技术**: 实现了将图片**字节数据直接嵌入** .myppt 文件（byte[] 方案），彻底解决了图片外部依赖问题，实现了图片的**永久化**。<br>- **默认尺寸**: 图片插入时会**智能限制默认显示尺寸**，避免过大或过小，并保持宽高比。                                                     |
|               | 8. 通过鼠标对幻灯片页面上已有的基本图形、线形、文字进行选取和移动 | ✅ **已完成** | - **选取**: 实现了单击选取，支持**点击空白处取消选择**，点击重叠对象时**优先选择顶层**。<br>- **移动**: 实现了选中后拖拽移动。<br>- **健壮性**: 解决了对象被拖到页面外后仍能选中的问题。                                                                                                                               |
|               | 9. 窗口中显示菜单与工具栏                     | ✅ **已完成** | 搭建了完整的 JMenuBar 和 JToolBar 框架。                                                                                                                                                                                                                 |
| **选做功能**      | 1. 幻灯片的全屏播放、翻页                     | ✅ **已完成** | - 实现了**无边框全屏播放**，支持键盘 (左右方向键, ESC) 和鼠标单击翻页与退出。<br>- **专业体验**: 播放时隐藏主窗口，退出后恢复；播放结束有**缓冲页提示信息**；播放时仅显示页面内内容，**自动裁剪边界外对象**。                                                                                                                       |
|               | 2. 对已有文字进行修改                       | ✅ **已完成** | 实现了对文字**内容**和**所有样式**（颜色/字体/大小/粗体/斜体）的完整修改。                                                                                                                                                                                                    |
|               | 3. 对已有基本图形进行修改                     | ✅ **已完成** | - 实现了对图形**填充色**、**边框色**（直线是线条色）、**边框粗细**、**边框线型**（实线/虚线/点线/无边框）和**大小**（通过拖拽控制点）的修改。                                                                                                                                                            |
|               | 4. 通过鼠标拖拽改变幻灯片页面上的图片大小             | ✅ **已完成** | - 不仅实现了自由拖拽缩放，还**超额完成**了按住 **Shift 键进行等比例缩放**的功能，并且该功能已**通用化**，支持所有对象。                                                                                                                                                                         |
|               | 5. 操作的撤销与重做                        | ✅ **已完成** | - **核心技术**: 基于**命令模式 (Command Pattern)**，为几乎所有编辑操作提供了完整的撤销和重做功能。<br>- **健壮性**: 解决了冗余命令和UI连锁更新等深层次 Bug，确保了撤销/重做操作的**精确性**和**可靠性**。<br>- **细节**: 撤销/重做后，**选中对象能保持选中状态**。                                                                         |
|               | 6. 其他（可参考PowerPoint）               | ✅ **已完成** | 我们新增了大量“其他”功能，详见下表。                                                                                                                                                                                                                            |
| **新增 (超额完成)** | **格式刷**                            | ✅ **已完成** | - **功能**: 选中源对象，点击格式刷，再点击目标对象，复制样式。<br>- **兼容性**: **支持文本框、矩形、椭圆、直线、图片**之间的**同类型样式复制**。<br>- **支持样式**: 包括颜色、字体、大小、粗细、线型、透明度等所有样式属性。<br>- **UI**: 鼠标在格式刷模式下变为**十字光标**，按 Esc 键可取消。<br>- **Undo/Redo**: 完美支持撤销/重做。                                 |
|               | **自动恢复**                           | ✅ **已完成** | - **核心**: 后台多线程**定时**将当前工作状态保存到隐藏的临时文件。<br>- **启动时**: 若检测到上次意外关闭，会弹窗询问是否恢复。<br>- **正常关闭时**: 自动清理临时文件，不留下垃圾。                                                                                                                                    |
|               | **导出为 PDF**                        | ✅ **已完成** | - 集成 Apache PDFBox 库，将所有幻灯片页面及其内部对象导出为高质量 PDF 文档。<br>- 支持所有对象类型、样式、图片透明度、**中文字体嵌入**。<br>- **椭圆绘制**精确。<br>- **异常处理**完善。                                                                                                                         |
|               | **对象层次管理**                         | ✅ **已完成** | - 通过右键菜单实现“置于顶层/底层”、“上移一层/下移一层”。<br>- **Undo/Redo**: 任何复杂的层次调整都能精确撤销/重做。                                                                                                                                                                       |
|               | **跨平台快捷键**                         | ✅ **已完成** | - **通用**: 完美兼容 Windows/Linux (Ctrl) 和 macOS (Command)。<br>- **快捷键列表**: 撤销 (Ctrl+Z), 重做 (Ctrl+Y/Cmd+Shift+Z), 删除 (Delete/Backspace), 播放 (F5), 复制 (Ctrl+C), 剪切 (Ctrl+X), 粘贴 (Ctrl+V), 保存(Ctrl+s)。                                                |
|               | 触摸板优化                              | ✅ **已完成** | 实现了对触摸板**两指左右滑动**来控制水平滚动条的功能。                                                                                                                                                                                                                  |
|               | 多页面管理                              | ✅ **已完成** | - **UI**: 实现了带**滚动条**的左侧动态缩略图列表，每个缩略图显示页码。<br>- **交互**: 支持点击缩略图**切换页面**，支持**删除页面**。<br>- **同步**: 实现了主编辑区与缩略图区的**实时双向数据同步**。                                                                                                                    |
|               | 删除功能增强                             | ✅ **已完成** | - 实现了**快捷键 (Delete/Backspace) 删除**和**右键菜单删除**两种方式。<br>- **细节**: 删除后，撤销能将对象**恢复到原始图层顺序**。                                                                                                                                                       |
|               | 高级交互架构                             | ✅ **已完成** | - 使用了**策略模式 (Strategy Pattern)** 重构了控制器，将“选择”、“绘制”等不同交互逻辑解耦到独立的策略类中，代码结构清晰、极易扩展。                                                                                                                                                               |
|               | 可交互属性栏UI                           | ✅ **已完成** | - **属性面板**: 能够根据当前选中对象的类型，**动态显示/隐藏/启用/禁用**相应的属性控件，使界面保持简洁和相关性。<br>- **鼠标光标**: 实现了当鼠标悬停在控制点上时，光标**自动变为对应的缩放箭头**。                                                                                                                               |
|               | **用户使用说明**                         | ✅ **已完成** | - 通过“帮助 -> 使用说明”菜单弹出。<br>- 内容**详尽全面**，涵盖大部分功能和快捷键。<br>- 使用 **HTML 格式渲染**，排版美观，突出项目亮点。                                                                                                                                                          |

---

**感谢您查阅本项目！希望您在使用 MyPPT 软件的过程中获得愉快的体验！**


